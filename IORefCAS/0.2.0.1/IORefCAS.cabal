Name:                IORefCAS
Version:             0.2.0.1
License:             BSD3
License-file:        LICENSE
Author:              Adam C. Foltzer, Ryan Newton
Maintainer:          acfoltzer@gmail.com, rrnewton@gmail.com
Category:            Data
Build-type:          Simple
Cabal-version:       >=1.8
HomePage: https://github.com/rrnewton/haskell-lockfree-queue/wiki

-- Version History:
-- 0.0.1   -- initial release
-- 0.0.1.1 -- minor bump to include README
-- 0.0.1.2 -- Egad, super minor update.
-- 0.1.0.1 -- Include ptrEq in Data.CAS
-- 0.2     -- Bumped for #if policy to test for GHC >7.2.  Removed casSTRef from the API for now.
-- 0.2.0.1 -- fix for test suite

Synopsis: Atomic compare and swap for IORefs and STRefs.

Description:

  After GHC 7.2 a new `casMutVar#` primop became available, but was
  not yet exposed in Data.IORef.  This package fills that gap until
  such a time as Data.IORef obsoletes it.
 .
  Further, in addition to exposing native Haskell CAS operations, this
  package contains \"mockups\" that imititate the same functionality
  using either atomicModifyIORef and unsafe pointer equality (in
  @Data.CAS.Fake@) or using foreign functions (@Data.CAS.Foreign@).
  These alternatives are useful for debugging.
  .
  Note that the foreign option does not operate on IORefs and so is
  directly interchangeable with `Data.CAS` and `Data.CAS.Fake` only if
  the interface in `Data.CAS.Class` is used.

Extra-Source-Files:
                     Makefile, Test.hs, README.md

Library
  exposed-modules:   Data.CAS,
                     Data.CAS.Internal.Class,
                     Data.CAS.Internal.Fake,
                     Data.CAS.Internal.Native
  if (!os(mingw32))
    exposed-modules: Data.CAS.Internal.Foreign
  -- I have observed problems on both Mac and Linux with 7.0.x.  [2011.12.23]
  -- Thus for now we require GHC 7.2 or greater (base 4.4 or greater).
  -- Namely Test.hs observes CAS failing half the time even with only ONE thread.
  -- This is probably a tricky pointer-equality related problem.
  build-depends:     base >= 4.4.0.0 && < 5,
                     ghc-prim, bits-atomic


-- Executable 
Test-Suite test-IORefCAS
    type:       exitcode-stdio-1.0
    main-is:    Test.hs
    ghc-options: -O2 -threaded -rtsopts
    cpp-options: -DT1 -DT2
    if !os(mingw32)
      cpp-options: -DT3
    build-depends: base >= 4.4 && < 5, time, ghc-prim,
                   QuickCheck, HUnit, bits-atomic
-- TODO: Refactor to use test-framework:
--                 , test-framework, test-framework-hunit
-- test-framework-quickcheck2

Source-Repository head
    Type:         git
    Location:     git://github.com/rrnewton/haskell-lockfree-queue.git


package-hashes:
    MD5:7835a0dff4233f1b773eb02d7fea8cc9
    SHA1:5215880aa7fceed5f5981318c78ad3edc2f443cf
    SHA256:abb984358deedcbc904899f19756487a86ce44264d520193c2158c9eca646e1b
    SHA512:798dc7f908f99b5eb2a383632a85aa09172fbc749aac9a129b95c88a45099228620d7d1b33d2e816c841cb48fc3e0eff199cdfd5d64c1347d9aebffd35098e7a
    Skein512_512:fb9b114412994bc9d9b6e87164497aaf2b536979abb70c231468549812b53b83d40931f0c649f578bab7ef3e8b06c7310b48534769b7c1eecb265576801afd6a

package-locations:
    https://hackage.haskell.org/package/IORefCAS-0.2.0.1/IORefCAS-0.2.0.1.tar.gz
    https://s3.amazonaws.com/hackage.fpcomplete.com/package/IORefCAS-0.2.0.1.tar.gz

package-size: 12617
